/* Original problink styling - scoped to extension */
.cm-extension .problink a {
  font-weight: 200;
  font-size: medium;
}

/* Simplified Problem Generator List */
.cm-extension .cd-simple-problems-list {
  display: flex !important;
  flex-direction: column !important;
  gap: 4px !important;
  max-height: 320px !important;
  overflow-y: hidden !important;
}

.cm-extension .cd-simple-problem-item {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 4px 0 !important;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
  cursor: pointer !important;
  overflow: hidden !important;
  width: 100% !important;
  max-width: 100% !important;
}

.cm-extension .cd-simple-problem-item:last-child {
  border-bottom: none !important;
}

.cm-extension .cd-simple-problem-link {
  color: var(--cm-text) !important;
  text-decoration: none !important;
  font-size: 16px !important;
  flex: 1 !important;
  line-height: 1.3 !important;
  margin-right: 8px !important;
}

.cm-extension .cd-simple-problem-item:hover .cd-simple-problem-link {
  color: var(--cm-link-hover) !important;
  font-size: 16px !important;
  font-weight: 400 !important;
}

.cm-extension .cd-simple-problem-item-container,
.cm-extension .cm-simple-problem-item-container {
  display: flex !important;
  flex-direction: column !important;
  gap: 2px !important;
}

/* Problem item layout - title and badges on same line */
.cm-extension .cm-simple-problem-item {
  display: flex !important;
  align-items: flex-start !important;
  justify-content: space-between !important;
  gap: 8px !important;
  width: 100% !important;
  min-height: 24px !important;
  box-sizing: border-box !important;
  flex-wrap: wrap !important;
  margin: 5px 0 !important;
}

/* Problem link styling */
.cm-extension .cm-simple-problem-link {
  color: var(--cm-text) !important;
  text-decoration: none !important;
  font-size: 14px !important;
  flex: 1 !important;
  line-height: 1.3 !important;

  min-width: 0 !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  white-space: normal !important;
  display: block !important;
  text-align: left !important;
}

/* Problem link hover state */
.cm-extension .cm-simple-problem-link:hover {
  color: var(--cm-link-hover) !important;
  text-decoration: none !important;
  opacity: 0.9 !important;
  font-size: 15px !important;
  font-weight: 500 !important;
}

.cm-extension .cd-problem-badges,
.cm-extension .cm-problem-badges {
  display: flex !important;
  align-items: center !important;
  gap: 4px !important;
  flex-shrink: 0 !important;
  overflow: visible !important;
  min-height: 20px !important;
  padding: 2px !important;
  box-sizing: border-box !important;
  background-color: rgba(255, 255, 255, 0.02) !important;
  border-radius: 4px !important;
  flex-wrap: wrap !important;
}

/* Problem info icon styling */
.cm-extension .cm-problem-info-icon {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  cursor: pointer !important;
  width: 14px !important;
  height: 14px !important;
  flex-shrink: 0 !important;
  position: relative !important;
  z-index: 1 !important;
  box-sizing: border-box !important;
  opacity: 0.9 !important;
}

.cm-extension .cd-new-tag,
.cm-extension .cm-new-tag {
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-dropdown-color) !important;
  font-size: 7px !important;
  font-weight: bold !important;
  padding: 1px 3px !important;
  border-radius: 2px !important;
  text-transform: uppercase !important;
  letter-spacing: 0.2px !important;
}

body[data-theme="dark"] .cm-extension .cd-new-tag,
body[data-theme="dark"] .cm-extension .cm-new-tag {
  background-color: var(--cm-active-blue) !important;
  color: var(--cm-btn-text) !important;
}

.cm-extension .cd-difficulty {
  font-size: 9px !important;
  padding: 1px 5px !important;
  border-radius: 8px !important;
  font-weight: 500 !important;
  text-transform: capitalize !important;
}

.cm-extension .cd-difficulty-easy {
  background-color: #10b981 !important;
  color: var(--cm-btn-text) !important;
}

.cm-extension .cd-difficulty-medium {
  background-color: #f59e0b !important;
  color: var(--cm-btn-text) !important;
}

.cm-extension .cd-difficulty-hard {
  background-color: #ef4444 !important;
  color: var(--cm-btn-text) !important;
}

.cm-extension .cd-problem-info-icon {
  flex-shrink: 0 !important;
  order: -1 !important;
  --cm-info-icon-bg: #3b82f6 !important; /* Blue for light mode */
}

body[data-theme="dark"] .cm-extension .cd-problem-info-icon {
  --cm-info-icon-bg: #60a5fa !important; /* Lighter blue for dark mode */
}

/* Problem Sidebar Styling - scoped to extension */
.cm-extension .problem-sidebar {
  width: clamp(240px, 22vw, 320px) !important;
  background-color: var(--cm-bg) !important;
  color: var(--cm-text) !important;
  height: 100vh !important;
  display: flex !important;
  flex-direction: column !important;
  padding: 0 !important;
  padding-top: var(--cm-content-padding, 10px) !important;
  margin: 0 !important;
  position: fixed !important;
  left: 0 !important;
  top: 0 !important;
  z-index: var(--cm-z-sidebar, 9200) !important;
  overflow-y: hidden !important;
  overflow-x: hidden !important;
  border-right: 1px solid var(--cm-dropdown-bg) !important;
  box-sizing: border-box !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
}





/* Problem sidebar section - scoped to extension */
.cm-extension .problem-sidebar-section {
  margin-bottom: 4px !important;
  padding: 0 2px !important;

  box-sizing: border-box !important;
  max-width: calc(100% - 4px) !important;
  width: calc(100% - 4px) !important;
  overflow: visible !important;
}

/* Specific override for tag strategy sections to allow expansion */
.cm-extension .problem-sidebar-section:has(.tag-strategy-simple-grid),
.cm-extension .problem-sidebar-section.tag-strategy-container {
  overflow: visible !important;
  position: relative !important;
  z-index: 10 !important;
  max-width: calc(100% - 8px) !important;
  width: calc(100% - 8px) !important;
  padding: 0 4px !important;
  /* Ensure adequate spacing around the container */
  margin-top: 2px !important;
  margin-bottom: 4px !important;
  /* Ensure adequate height for all tags */
  min-height: fit-content !important;
  height: auto !important;
  max-height: none !important;
}

/* Enhanced scrolling behavior for tag strategy expansion */
.cm-extension .problem-sidebar-section.tag-strategy-container .tag-strategy-hint {
  /* Ensure strategy hints don't break out of scrollable area */
  max-width: 100% !important;
  box-sizing: border-box !important;
  /* Add scroll into view behavior when expanded */
  scroll-margin-top: 20px !important;
  /* Remove margin to eliminate gap between tag and strategy */
  margin-top: 0px !important;
  /* Ensure proper z-index layering */
  position: relative !important;
  z-index: 10 !important;
}

/* Ensure problem card has adequate spacing from tag strategies */
.cm-extension .problem-sidebar-card {
  margin-bottom: 16px !important;
  /* Ensure the problem card content is never obscured */
  position: relative !important;
  z-index: 20 !important;
}

/* Ensure problem sidebar maintains proper scrolling with expanded content */
.cm-extension .cd-sidenav.problem-sidebar-view {
  /* Ensure the sidebar itself doesn't grow beyond viewport */
  max-height: 100vh !important;
  overflow: visible !important;
}

.cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content {
  /* Enable smooth scrolling within the content area */
  scroll-behavior: smooth !important;
  /* Add subtle scroll padding for better UX */
  scroll-padding-top: 8px !important;
  scroll-padding-bottom: 8px !important;
  /* Optimize padding to fit content */
  padding: 2px 0 !important;
  overflow-x: hidden !important;
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box !important;
}

/* Override height constraints when tiers are expanded in strategy map */
.cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content:has(.tag-strategy-container .tag-strategy-simple-grid) {
  /* Allow full expansion when strategy content is expanded */
  max-height: none !important;
  height: auto !important;
  overflow-y: visible !important;
}

/* Specific override for strategy map expansion */
.cm-extension .cm-sidenav .tag-strategy-simple-grid {
  /* Ensure the grid container can expand to full height */
  max-height: none !important;
  height: auto !important;
  overflow: visible !important;
}

/* Prevent expanded strategy content from causing horizontal overflow */
.cm-extension .problem-sidebar-section.tag-strategy-container .tag-strategy-hint-content {
  max-width: calc(100% - 4px) !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  box-sizing: border-box !important;
}

/* Animation and styling for expanded strategy hints */
.cm-extension .tag-strategy-hint.expanded {
  /* Remove scaling to prevent gap issues */
  transform: none !important;
  transition: transform 0.2s ease-out !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
}

.cm-extension .tag-strategy-hint.expanded .tag-strategy-hint-content {
  animation: slideInExpand 0.3s ease-out !important;
}

@keyframes slideInExpand {
  from {
    opacity: 0.7;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Problem sidebar section headers and elements - scoped to extension */
.cm-extension .problem-sidebar-section-header {
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;
  color: var(--cm-text) !important;
  opacity: 0.8 !important;
  font-size: 14px !important;
  margin-bottom: 12px !important;
}

.cm-extension .problem-sidebar-section-icon {
  height: 16px !important;
  width: 16px !important;
}

.cm-extension .problem-sidebar-section-title {
  font-weight: 500 !important;
}

.cm-extension .problem-sidebar-tags {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 8px !important;
  max-width: 100% !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
}

.cm-extension .problem-sidebar-tag {
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  font-size: 10px !important;
  padding: 4px 8px !important;
  border-radius: 9999px !important;
  transition: background-color 0.2s ease !important;
  opacity: 0.8 !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  max-width: 100% !important;
  flex-shrink: 1 !important;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;
}

.cm-extension .problem-sidebar-tag:hover {
  opacity: 1 !important;
}

.cm-extension .problem-sidebar-no-tags {
  color: var(--cm-text) !important;
  opacity: 0.7 !important;
  font-size: 14px !important;
}


.cm-extension .problem-sidebar-actions {
  margin-top: 8px !important;
  display: flex !important;
  flex-direction: column !important;
  gap: 4px !important;
  padding: 2px 4px 6px 4px !important;
  box-sizing: border-box !important;
  align-items: center !important;
  justify-content: center !important;
  text-align: center !important;
  max-width: 100% !important;
  width: 100% !important;
}

.cm-extension .problem-sidebar-primary-btn {
  width: auto !important;
  min-width: 140px !important;
  max-width: 90% !important;
  background-color: var(--cm-btn-bg) !important;
  color: var(--cm-btn-text) !important;
  font-weight: 600 !important;
  padding: 8px 16px !important;
  font-size: 14px !important;
  border-radius: 6px !important;
  border: none !important;
  transition: background-color 0.2s ease !important;
  box-sizing: border-box !important;
  outline: none !important;
  align-self: center !important;
}

.cm-extension .problem-sidebar-primary-btn:hover {
  background-color: var(--cm-active-blue) !important;
}

/* Remove all focus and active blue effects */
.cm-extension .problem-sidebar-primary-btn:focus,
.cm-extension .problem-sidebar-primary-btn:active,
.cm-extension .problem-sidebar-primary-btn:focus-visible {
  background-color: var(--cm-btn-bg) !important;
  outline: none !important;
  box-shadow: none !important;
  border: none !important;
}


/* Remove pseudo-element styles */
.cm-extension .problem-sidebar-primary-btn:before,
.cm-extension .problem-sidebar-primary-btn:after {
  display: none !important;
}

.cm-extension .problem-sidebar-btn-icon {
  height: 16px !important;
  width: 16px !important;
  margin-right: 8px !important;
}

.cm-extension .problem-sidebar-skip-btn {
  color: #9ca3af !important;
  background: none !important;
  border: none !important;
  padding: 4px 8px !important;
  font-size: 12px !important;
  text-align: center !important;
  cursor: pointer !important;
  font-weight: normal !important;
  text-decoration: none !important;
  display: block !important;
  align-self: center !important;
  width: auto !important;
  min-width: 100px !important;
}


/* Screen reader only class - scoped to extension */
.cm-extension .sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/* Force all child elements to respect width constraints - scoped to extension */
.cm-extension .problem-sidebar * {
  max-width: 100% !important;
  box-sizing: border-box !important;
}

/* ============================================================================
   MANTINE COMPONENT OVERRIDES - Consolidated
   ============================================================================ */

/* General Mantine component widths and sizing - scoped to extension */
.cm-extension .problem-sidebar .mantine-Badge-root,
.cm-extension .problem-sidebar .mantine-Button-root {
  max-width: 100% !important;
  box-sizing: border-box !important;
  overflow: hidden !important;
}

/* Mantine button focus/active state overrides */
.cm-extension [class*="mantine"][class*="Button"]:focus,
.cm-extension [class*="mantine"][class*="Button"]:active,
.cm-extension [class*="mantine"][class*="Button"]:focus-visible {
  background-color: var(--cm-btn-bg) !important;
  outline: none !important;
  box-shadow: none !important;
  border: none !important;
}

/* Mantine skip button styles */
.cm-extension .problem-sidebar-skip-btn,
.cm-extension button.problem-sidebar-skip-btn,
.cm-extension [class*="mantine"].problem-sidebar-skip-btn,
.cm-extension [class*="Button"].problem-sidebar-skip-btn {
  color: #9ca3af !important;
  background-color: transparent !important;
  background: none !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
  text-decoration: none !important;
  font-weight: normal !important;
}

.cm-extension .problem-sidebar-skip-btn:hover {
  color: #d1d5db !important;
  background: none !important;
  text-decoration: none !important;
}

/* Mantine skip button hover/focus/active states */
.cm-extension .problem-sidebar-skip-btn:hover,
.cm-extension .problem-sidebar-skip-btn:focus,
.cm-extension .problem-sidebar-skip-btn:active,
.cm-extension .problem-sidebar-skip-btn:focus-visible,
.cm-extension button.problem-sidebar-skip-btn:hover,
.cm-extension button.problem-sidebar-skip-btn:focus,
.cm-extension button.problem-sidebar-skip-btn:active,
.cm-extension button.problem-sidebar-skip-btn:focus-visible,
.cm-extension [class*="mantine"].problem-sidebar-skip-btn:hover,
.cm-extension [class*="mantine"].problem-sidebar-skip-btn:focus,
.cm-extension [class*="mantine"].problem-sidebar-skip-btn:active,
.cm-extension [class*="mantine"].problem-sidebar-skip-btn:focus-visible,
.cm-extension [class*="Button"].problem-sidebar-skip-btn:hover,
.cm-extension [class*="Button"].problem-sidebar-skip-btn:focus,
.cm-extension [class*="Button"].problem-sidebar-skip-btn:active,
.cm-extension [class*="Button"].problem-sidebar-skip-btn:focus-visible {
  color: #d1d5db !important;
  background-color: transparent !important;
  background: none !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
  text-decoration: none !important;
}

/* ============================================================================
   COMPREHENSIVE TAG LAYOUT SOLUTIONS - Multiple Approaches for 2-Column Grid
   ============================================================================ */

/* SOLUTION 1: CSS GRID APPROACH (PRIMARY - MOST ROBUST) */
.cm-extension .tag-strategy-simple-grid {
  /* Force CSS Grid layout - single column for wider buttons */
  display: grid !important;
  grid-template-columns: 1fr !important;
  grid-gap: 8px !important;
  gap: 8px !important;
  margin-bottom: 12px !important;
  width: 100% !important;
  box-sizing: border-box !important;

  /* Ensure container takes full width */
  min-width: 100% !important;
  max-width: 100% !important;

  /* Reset any inherited flex properties */
  flex-direction: initial !important;
  flex-wrap: initial !important;
  justify-content: initial !important;
  align-items: initial !important;
}

/* SOLUTION 2: ENHANCED FLEXBOX APPROACH (FALLBACK) */
.tag-strategy-simple-grid.use-flexbox {
  display: flex !important;
  flex-direction: column !important;
  flex-wrap: nowrap !important;
  justify-content: flex-start !important;
  align-items: stretch !important;
  gap: 8px !important;
  margin-bottom: 12px !important;
  width: 100% !important;
  min-width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box !important;

  /* Force column layout for single column */
  align-content: stretch !important;
}

/* COMPREHENSIVE BUTTON STYLES FOR ALL LAYOUT APPROACHES - scoped to extension */
.cm-extension .tag-strategy-button {
  /* Grid layout properties - works with Solution 1 (CSS Grid) */
  grid-column: span 1 !important;

  /* Flexbox layout properties - works with Solution 2 (Enhanced Flexbox) */
  width: 100% !important;
  min-width: 100% !important;
  max-width: 100% !important;
  flex-shrink: 0 !important;
  flex-grow: 0 !important;
  flex-basis: 100% !important;
  padding: 12px 20px !important;
  border: 1px solid transparent !important;
  border-radius: 20px !important;
  background: none !important;
  font-size: 14px !important;
  font-weight: 500 !important;
  cursor: pointer !important;
  outline: none !important; /* Remove focus outline */

  text-align: center !important;
  min-height: 40px !important;
  line-height: 1.3 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  box-sizing: border-box !important;
  white-space: normal !important;
  word-wrap: break-word !important;
  overflow: visible !important;
  text-overflow: unset !important;
}

/* Remove focus outline on tag strategy buttons - aggressive override for LeetCode */
.cm-extension .tag-strategy-button:focus,
.cm-extension .tag-strategy-button:focus-visible,
.cm-extension button.tag-strategy-button:focus,
.cm-extension button.tag-strategy-button:focus-visible,
.tag-strategy-button:focus,
.tag-strategy-button:focus-visible,
button.tag-strategy-button:focus,
button.tag-strategy-button:focus-visible {
  outline: none !important;
  outline-width: 0 !important;
  outline-style: none !important;
  box-shadow: none !important;
  border-color: transparent !important;
}

/* LeetCode Badge Theme Styles */

/* Light theme badge styling (default) */
.cm-extension .tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ) {
  /* Removed yellow background - keep only transform effect */
  color: var(--cm-text) !important;
  transform: translateY(-1px) !important;
}

/* Prevent hover effect on expanded buttons */
.cm-extension .tag-strategy-button-expanded:hover {
  transform: none !important;
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
}

.cm-extension .tag-strategy-button-expanded {
  /* TAB SHAPE: Match strategy content styling */
  border-radius: 8px 8px 0 0 !important;
  background-color: var(--cm-dropdown-bg) !important;
  border: 1px solid var(--cm-link) !important;
  border-bottom: none !important;
  color: var(--cm-text) !important;
  font-weight: 600 !important;
  box-shadow: none !important;
  z-index: 2 !important;
  margin-bottom: -2px !important;
  transform: none !important;
  position: relative !important;
}

/* Dark theme badge styling */
body[data-theme="dark"] .cm-extension .tag-strategy-button {
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
}

body[data-theme="dark"] .cm-extension
  .tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ) {
  /* Removed yellow background - keep only transform effect */
  color: var(--cm-text) !important;
  transform: translateY(-1px) !important;
}

/* Prevent hover effect on expanded buttons in dark theme */
body[data-theme="dark"] .cm-extension .tag-strategy-button-expanded:hover {
  transform: none !important;
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
}

body[data-theme="dark"] .cm-extension .tag-strategy-button-expanded {
  /* DARK THEME TAB SHAPE: Match strategy content styling */
  border-radius: 8px 8px 0 0 !important;
  background-color: var(--cm-dropdown-bg) !important;
  border: 1px solid var(--cm-link) !important;
  border-bottom: none !important;
  color: var(--cm-text) !important;
  font-weight: 600 !important;
  box-shadow: none !important;
  z-index: 2 !important;
  margin-bottom: -2px !important;
  transform: none !important;
  position: relative !important;
}

/* Light theme specific overrides */
body[data-theme="light"] .cm-extension .tag-strategy-button {
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
}

.cm-extension .tag-strategy-indicator {
  font-size: 10px !important;
  margin-left: 4px !important;
  opacity: 0.8 !important;
}

.cm-extension .tag-strategy-hint {
  grid-column: 1 / -1 !important;
  width: 100% !important;
  margin-top: 0px !important;
  margin-bottom: 8px !important;
  animation: slideDown 0.2s ease-out !important;
}

/* Dark mode strategy content */
body[data-theme="dark"] .cm-extension .tag-strategy-hint-content {
  background-color: var(--cm-dropdown-bg, #374151) !important;
  border: none !important;
  border-radius: 0 0 8px 8px !important;
  padding: 12px !important;
  font-size: 13px !important;
  line-height: 1.4 !important;
  position: relative !important;
  z-index: 1 !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
  color: var(--cm-text, #f3f4f6) !important;
  margin-top: -1px !important;
}

body[data-theme="dark"] .cm-extension .tag-strategy-hint-title {
  font-weight: 600 !important;
  color: var(--cm-text, #f3f4f6) !important;
  font-size: 14px !important;
}

body[data-theme="dark"] .cm-extension .tag-strategy-hint-body {
  color: var(--cm-text, #f3f4f6) !important;
  margin-bottom: 6px !important;
  font-size: 13px !important;
  line-height: 1.4 !important;
  font-weight: 400 !important;
}

/* Light mode strategy content */
body[data-theme="light"] .cm-extension .tag-strategy-hint-content {
  background-color: var(--cm-dropdown-bg, #ffffff) !important;
  border: none !important;
  border-radius: 0 0 8px 8px !important;
  padding: 12px !important;
  font-size: 13px !important;
  margin-top: 0px !important;
  line-height: 1.4 !important;
  position: relative !important;
  z-index: 1 !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
  color: var(--cm-text, #374151) !important;
}

body[data-theme="light"] .cm-extension .tag-strategy-hint-title {
  font-weight: 600 !important;
  color: var(--cm-text, #374151) !important;
  font-size: 14px !important;
}

body[data-theme="light"] .cm-extension .tag-strategy-hint-body {
  color: var(--cm-text, #374151) !important;
  margin-bottom: 6px !important;
  font-size: 13px !important;
  line-height: 1.4 !important;
  font-weight: 400 !important;
}

/* Default fallback styles */
.cm-extension .tag-strategy-hint-content {
  background-color: #ffffff !important;
  border: none !important;
  border-radius: 0 0 8px 8px !important;
  padding: 12px !important;
  font-size: 13px !important;
  line-height: 1.4 !important;
  position: relative !important;
  z-index: 1 !important;
  box-shadow: none !important;
  color: #374151 !important;
  margin-top: -1px !important;
}

.cm-extension .tag-strategy-hint-header {
  display: flex !important;
  align-items: center !important;
  margin-bottom: 8px !important;
}

.cm-extension .tag-strategy-hint-title {
  font-weight: 600 !important;
  color: #374151 !important;
  font-size: 14px !important;
}

.cm-extension .tag-strategy-hint-body {
  color: #374151 !important;
  margin-bottom: 6px !important;
  font-size: 13px !important;
  line-height: 1.4 !important;
  font-weight: 400 !important;
}

.cm-extension .tag-strategy-hint-patterns {
  margin-top: 6px !important;
}

/* Dark mode patterns */
body[data-theme="dark"] .cm-extension .tag-strategy-hint-patterns-title {
  font-weight: 500 !important;
  color: rgba(255, 255, 255, 0.9) !important;
  font-size: 10px !important;
  margin-bottom: 3px !important;
}

body[data-theme="dark"] .cm-extension .tag-strategy-hint-pattern {
  background-color: #4b5563 !important;
  color: #f3f4f6 !important;
  padding: 1px 4px !important;
  border-radius: 3px !important;
  font-size: 9px !important;
  border: none !important;
}

/* Light mode patterns */
body[data-theme="light"] .cm-extension .tag-strategy-hint-patterns-title {
  font-weight: 500 !important;
  color: rgba(0, 0, 0, 0.7) !important;
  font-size: 10px !important;
  margin-bottom: 3px !important;
}

body[data-theme="light"] .cm-extension .tag-strategy-hint-pattern {
  background-color: #f9fafb !important;
  color: #374151 !important;
  padding: 1px 4px !important;
  border-radius: 3px !important;
  font-size: 9px !important;
  border: 1px solid #e5e7eb !important;
}

/* Common pattern styles */
.cm-extension .tag-strategy-hint-patterns-title {
  font-weight: 500 !important;
  color: rgba(0, 0, 0, 0.7) !important;
  font-size: 10px !important;
  margin-bottom: 3px !important;
}

.cm-extension .tag-strategy-hint-patterns-list {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 3px !important;
}

.cm-extension .tag-strategy-hint-pattern {
  background-color: #f9fafb !important;
  color: #374151 !important;
  padding: 1px 4px !important;
  border-radius: 3px !important;
  font-size: 9px !important;
  border: 1px solid #e5e7eb !important;
}

.cm-extension .tag-strategy-hint-empty {
  color: rgba(255, 255, 255, 0.6) !important;
  font-style: italic !important;
  text-align: center !important;
  padding: 8px !important;
}

.cm-extension .tag-strategy-loading {
  grid-column: 1 / -1 !important;
  text-align: center !important;
  color: rgba(255, 255, 255, 0.7) !important;
  font-size: 12px !important;
  padding: 8px !important;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ============================================================================
   ADDITIONAL LAYOUT SOLUTIONS AND COMPREHENSIVE OVERRIDES
   ============================================================================ */

/* SOLUTION 3: FLOAT-BASED APPROACH (MAXIMUM COMPATIBILITY) */
.tag-strategy-simple-grid.use-float {
  display: block !important;
  width: 100% !important;
  box-sizing: border-box !important;
  margin-bottom: 8px !important;
  /* Clear floats */
  overflow: hidden !important;
  zoom: 1 !important; /* IE fix */
}

.tag-strategy-simple-grid.use-float::after {
  content: "" !important;
  display: table !important;
  clear: both !important;
}

.tag-strategy-simple-grid.use-float .tag-strategy-button {
  float: left !important;
  width: calc(50% - 1px) !important;
  margin-right: 2px !important;
  margin-bottom: 2px !important;
  box-sizing: border-box !important;
}

.tag-strategy-simple-grid.use-float .tag-strategy-button:nth-child(2n) {
  margin-right: 0 !important;
  float: right !important;
}

/* SOLUTION 4: SUPER AGGRESSIVE OVERRIDE FOR STUBBORN CASES */
body .problem-sidebar .problem-sidebar-section .cm-extension .tag-strategy-simple-grid {
  display: grid !important;
  grid-template-columns: repeat(2, 1fr) !important;
  grid-gap: 0px !important;
  width: 100% !important;
  box-sizing: border-box !important;
}

body
  .problem-sidebar
  .problem-sidebar-section
  .tag-strategy-simple-grid
  .tag-strategy-button {
  grid-column: span 1 !important;
  width: auto !important;
  box-sizing: border-box !important;
}

/* SOLUTION 5: INLINE-BLOCK APPROACH */
.tag-strategy-simple-grid.use-inline-block {
  display: block !important;
  width: 100% !important;
  text-align: justify !important;
  font-size: 0 !important; /* Remove whitespace */
  box-sizing: border-box !important;
  margin-bottom: 8px !important;
}

.tag-strategy-simple-grid.use-inline-block::after {
  content: "" !important;
  display: inline-block !important;
  width: 100% !important;
  height: 0 !important;
}

.tag-strategy-simple-grid.use-inline-block .tag-strategy-button {
  display: inline-block !important;
  width: calc(50% - 1px) !important;
  font-size: 10px !important; /* Restore font size */
  text-align: center !important;
  vertical-align: top !important;
  box-sizing: border-box !important;
}

/* NUCLEAR OPTION: FORCE 2-COLUMN WITH MAXIMUM SPECIFICITY */
html
  body
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .cm-extension .tag-strategy-simple-grid {
  display: grid !important;
  grid-template-columns: 1fr 1fr !important;
  grid-gap: 4px !important;
  gap: 4px !important;
  width: 100% !important;
  box-sizing: border-box !important;
  /* Ensure adequate height for all tags */
  min-height: fit-content !important;
  height: auto !important;
  /* Override any possible flex properties */
  flex-direction: unset !important;
  flex-wrap: unset !important;
  justify-content: unset !important;
  align-items: unset !important;
  align-content: unset !important;
}

html
  body
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button {
  width: auto !important;
  min-width: 0 !important;
  max-width: none !important;
  flex-basis: auto !important;
  flex-grow: 0 !important;
  flex-shrink: 0 !important;
  grid-column: span 1 !important;
  box-sizing: content-box !important;
  padding: 12px 16px !important;
  font-size: 13px !important;
  min-height: 40px !important;
  height: auto !important;
  line-height: 1.3 !important;
  white-space: normal !important;
  word-wrap: break-word !important;
}

/* Responsive adjustments for tag grid */
@media screen and (max-width: 220px) {
  .tag-strategy-simple-grid,
  .tag-strategy-simple-grid.use-flexbox,
  .tag-strategy-simple-grid.use-float,
  .tag-strategy-simple-grid.use-inline-block,
  html
    body
    .problem-sidebar
    .problem-sidebar-section.tag-strategy-container
    .cm-extension .tag-strategy-simple-grid {
    grid-template-columns: 1fr !important;
  }

  .tag-strategy-simple-grid.use-float .tag-strategy-button,
  .tag-strategy-simple-grid.use-inline-block .tag-strategy-button {
    width: 100% !important;
    float: none !important;
    margin-right: 0 !important;
  }
}

/* ============================================================================
   COMPREHENSIVE TAG STRATEGY FIXES - DEFINITIVE SOLUTION
   ============================================================================ */

/* CRITICAL SCROLLING FIXES - Allow content scrolling - scoped to extension */
.cm-extension .problem-sidebar {
  /* Allow scrolling behavior */
  overflow-y: visible !important;
  overflow-x: hidden !important;
  /* Smooth scrolling for better UX */
  scroll-behavior: smooth !important;
  /* Ensure content doesn't get cut off */
  height: 100vh !important;
  max-height: 100vh !important;
}

.cm-extension .cd-sidenav__content {
  /* Critical: Allow proper scrolling when content expands */
  overflow-y: auto !important;
  overflow-x: hidden !important;
  /* Ensure full height usage with proper padding */
  height: calc(100vh - 90px) !important;
  max-height: calc(100vh - 90px) !important;
  /* Add padding to prevent content cutoff */
  padding-bottom: 5px !important;
  /* Enable smooth scrolling */
  scroll-behavior: smooth !important;
  /* Fix webkit scrolling issues */
  -webkit-overflow-scrolling: touch !important;
}

/* REMOVED - Using simplified .tag-strategy-button selector instead */

/* REMOVED - Using simplified selectors instead */

/* REMOVED - Using simplified selectors instead */

/* REMOVED - Updated version exists below */

/* REMOVED - Redundant grid layout rule */

/* RESPONSIVE BREAKPOINTS FOR TAG BUTTONS */
@media screen and (max-width: 280px) {
  .tag-strategy-button {
    padding: 10px 16px !important;
    min-height: 40px !important;
    font-size: 13px !important;
  }
}

@media screen and (min-width: 281px) {
  .tag-strategy-button {
    padding: 12px 20px !important;
    min-height: 44px !important;
    font-size: 14px !important;
  }
}

@media screen and (min-width: 320px) {
  .tag-strategy-button {
    padding: 14px 24px !important;
    min-height: 48px !important;
    font-size: 15px !important;
  }
}

/* FORCE VISIBILITY AND PREVENT HIDDEN BUTTONS */
.tag-strategy-button {
  visibility: visible !important;
  opacity: 1 !important;
  display: flex !important;
  position: relative !important;
  z-index: 1 !important;
}

/* ENHANCED HOVER EFFECTS FOR LARGER BUTTONS */
.tag-strategy-button:hover {
  transform: translateY(-2px) scale(1.02) !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;

}

/* PREVENT CONTENT CUTOFF ON SMALL SCREENS */
@media screen and (max-height: 700px) {
  .cd-sidenav__content {
    padding-bottom: 5px !important;
  }

  .problem-sidebar-actions {
    position: sticky !important;
    bottom: 0 !important;
    background: var(--cm-bg) !important;
    z-index: 15 !important;
    padding-top: 4px !important;
    margin-top: 6px !important;
    border-top: 1px solid var(--cm-border) !important;
    border-top-color: transparent !important;
  }
}

/* CUSTOM SCROLLBAR FOR BETTER UX */
.cd-sidenav__content::-webkit-scrollbar {
  width: 12px !important;
}

.cd-sidenav__content::-webkit-scrollbar-track {
  background: var(--cm-dropdown-bg) !important;
  border-radius: 6px !important;
}

.cd-sidenav__content::-webkit-scrollbar-thumb {
  background: var(--cm-btn-bg) !important;
  border-radius: 6px !important;
  border: 2px solid var(--cm-dropdown-bg) !important;
}

.cd-sidenav__content::-webkit-scrollbar-thumb:hover {
  background: var(--cm-active-blue) !important;
}

/* FINAL NUCLEAR APPROACH: ATTRIBUTE SELECTORS */
button[class*="tag-strategy"][type="button"] {
  /* MAXIMUM OVERRIDE POWER */
  padding: 24px 36px !important;
  min-height: 64px !important;
  font-size: 18px !important;
  font-weight: 900 !important;
  width: calc(50% - 10px) !important;
  margin: 5px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  box-sizing: border-box !important;
  border-radius: 14px !important;
  line-height: 1.2 !important;
  white-space: normal !important;
  word-wrap: break-word !important;
  text-align: center !important;
}

/* DEBUG MODE - Uncomment to visualize layout issues */
/*
.cm-extension .tag-strategy-simple-grid {
  border: 2px solid red !important;
  background-color: rgba(255, 0, 0, 0.1) !important;
}

.tag-strategy-button {
  border: 1px solid blue !important;
  background-color: rgba(0, 0, 255, 0.1) !important;
}
*/

/* NUCLEAR SOLUTION: FORCE LARGE TAG BUTTONS - MAXIMUM SPECIFICITY */
html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button {
  /* Force large button sizing */
  padding: 8px 16px !important;
  font-size: 13px !important;
  min-height: 40px !important;
  height: auto !important;
  line-height: 1.3 !important;

  /* Override all width constraints */
  width: auto !important;
  min-width: 0 !important;
  max-width: none !important;
  flex-basis: auto !important;
  flex-grow: 1 !important;
  flex-shrink: 0 !important;

  /* Force proper display and sizing */
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  box-sizing: border-box !important;

  /* Allow text wrapping for better display */
  white-space: normal !important;
  word-wrap: break-word !important;
  text-align: center !important;

  /* Enhanced visual styling */
  font-weight: 600 !important;
  border-radius: 8px !important;

}

/* Override the responsive media query that forces single column */
@media screen and (max-width: 220px) {
  html
    body
    div.cd-sidenav
    div.cd-sidenav__content
    .problem-sidebar-section.tag-strategy-container
    .cm-extension .tag-strategy-simple-grid {
    grid-template-columns: 1fr 1fr !important; /* Keep 2 columns even on narrow screens */
  }

  html
    body
    div.cd-sidenav
    div.cd-sidenav__content
    .problem-sidebar-section.tag-strategy-container
    .tag-strategy-simple-grid
    .tag-strategy-button {
    width: auto !important;
    min-width: 0 !important;
    padding: 6px 12px !important; /* Adjusted padding for very narrow screens while still readable */
    font-size: 12px !important;
  }
}

/* Tag Strategy Grid - Compact layout with theme-appropriate styling */
html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .cm-extension .tag-strategy-simple-grid {
  display: grid !important;
  grid-template-columns: 1fr 1fr !important;
  gap: 0px !important; /* Critical: No gap between grid items */
  grid-gap: 0px !important; /* Fallback for older browsers */
  width: 100% !important;
  box-sizing: border-box !important;
}

html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button,
body
  .problem-sidebar
  .problem-sidebar-section
  .tag-strategy-simple-grid
  .tag-strategy-button[class*="tag-strategy-button"],
.tag-strategy-simple-grid .tag-strategy-button[type="button"] {
  /* Smaller, more compact pill styling */
  width: auto !important;
  min-width: 48% !important;
  max-width: none !important;
  padding: 8px 12px !important; /* Slightly larger padding for visibility */
  margin: 4px !important; /* Even more margin to make separation obvious */
  min-height: 36px !important; /* Slightly taller for visibility */
  height: auto !important;

  /* Typography - Compact but readable */
  font-size: 11px !important;
  font-weight: 500 !important;
  line-height: 1.2 !important;
  text-align: center !important;
  white-space: nowrap !important;
  overflow: hidden !important;
  text-overflow: ellipsis !important;

  /* Pill shape with smaller radius */
  border-radius: 16px !important;

  /* Layout */
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  box-sizing: border-box !important;
  cursor: pointer !important;

  /* Transitions for smooth pill-to-tab animation */


  /* Position */
  position: relative !important;
  z-index: 1 !important;

  /* Colors - theme integrated */
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  border: none !important; /* Remove border for cleaner look */
}

/* NUCLEAR HOVER STATE: Maximum Specificity - Removed yellow background */
html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ),
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ),
body
  .problem-sidebar
  .problem-sidebar-section
  .tag-strategy-simple-grid
  .tag-strategy-button[class*="tag-strategy-button"]:hover:not(
    .tag-strategy-button-expanded
  ):not(.tag-strategy-no-hover),
.tag-strategy-simple-grid
  .tag-strategy-button[type="button"]:hover:not(
    .tag-strategy-button-expanded
  ):not(.tag-strategy-no-hover) {
  /* Removed yellow background - keep only transform and shadow effects */
  color: var(--cm-text) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
}

/* NUCLEAR EXPANDED STATE: Transform to tab shape with maximum specificity */
html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded,
body
  .problem-sidebar
  .problem-sidebar-section
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[class*="tag-strategy-button"],
.tag-strategy-simple-grid .tag-strategy-button-expanded[type="button"],
.tag-strategy-button-expanded {
  /* TAB SHAPE: Rounded top corners, square bottom for seamless connection */
  border-radius: 8px 8px 0 0 !important;
  background-color: var(--cm-dropdown-bg) !important;
  border: none !important;
  color: var(--cm-text) !important;
  font-weight: 600 !important;

  /* Position for seamless connection - remove all margins */
  z-index: 2 !important;
  margin: 0px !important;
  margin-bottom: 0px !important; /* Critical: No gap between tab and content */
  position: relative !important;

  /* Remove transform effects when expanded */
  transform: none !important;
  box-shadow: none !important;

  /* Ensure tab connects perfectly to content */
  border-bottom: none !important;
}

/* NUCLEAR EXPANDED HOVER: Prevent hover effects on expanded buttons */
html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded:hover,
body
  .problem-sidebar
  .problem-sidebar-section
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[class*="tag-strategy-button"]:hover,
.tag-strategy-simple-grid .tag-strategy-button-expanded[type="button"]:hover,
.tag-strategy-button-expanded:hover {
  transform: none !important;
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  box-shadow: none !important;
  border-radius: 8px 8px 0 0 !important;
}

/* NUCLEAR DARK THEME: Maximum Specificity */
html
  body[data-theme="dark"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button,
html
  body[data-theme="dark"]
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button,
body[data-theme="dark"]
  .problem-sidebar
  .problem-sidebar-section
  .tag-strategy-simple-grid
  .tag-strategy-button[class*="tag-strategy-button"],
body[data-theme="dark"]
  .tag-strategy-simple-grid
  .tag-strategy-button[type="button"] {
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  border: 1px solid var(--cm-link) !important;
}

html
  body[data-theme="dark"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ),
html
  body[data-theme="dark"]
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ),
body[data-theme="dark"]
  .problem-sidebar
  .problem-sidebar-section
  .tag-strategy-simple-grid
  .tag-strategy-button[class*="tag-strategy-button"]:hover:not(
    .tag-strategy-button-expanded
  ):not(.tag-strategy-no-hover),
body[data-theme="dark"]
  .tag-strategy-simple-grid
  .tag-strategy-button[type="button"]:hover:not(
    .tag-strategy-button-expanded
  ):not(.tag-strategy-no-hover) {
  /* Removed yellow background for dark theme too */
  color: var(--cm-text) !important;
}

html
  body[data-theme="dark"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded,
html
  body[data-theme="dark"]
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded,
body[data-theme="dark"]
  .problem-sidebar
  .problem-sidebar-section
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[class*="tag-strategy-button"],
body[data-theme="dark"]
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[type="button"],
body[data-theme="dark"] .tag-strategy-button-expanded {
  background-color: var(--cm-dropdown-bg) !important;
  border: none !important;
  color: var(--cm-text) !important;
  margin: 0px !important;
  position: relative !important;
  z-index: 2 !important;
  border-radius: 8px 8px 0 0 !important;
}

html
  body[data-theme="dark"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded:hover,
html
  body[data-theme="dark"]
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded:hover,
body[data-theme="dark"]
  .problem-sidebar
  .problem-sidebar-section
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[class*="tag-strategy-button"]:hover,
body[data-theme="dark"]
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[type="button"]:hover,
body[data-theme="dark"] .tag-strategy-button-expanded:hover {
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  transform: none !important;
  box-shadow: none !important;
  border-radius: 8px 8px 0 0 !important;
}

/* Strategy hint container - spans full grid width with seamless connection */
.cm-extension .tag-strategy-hint {
  grid-column: 1 / -1 !important;
  width: 100% !important;
  margin-top: 0px !important; /* No gap between tab and content */
  margin-bottom: 16px !important;
  position: relative !important;
  z-index: 1 !important;
  animation: expandStrategy 0.3s ease-out !important;
}

/* Strategy content that connects seamlessly to the tab */
.cm-extension .tag-strategy-hint-content {
  background-color: var(--cm-dropdown-bg) !important; /* Use theme colors */
  border: none !important; /* Remove all borders */
  border-radius: 0 10px 10px 10px !important; /* Match 10px radius, round all corners except top-left */
  padding: 12px !important;
  margin-top: 0px !important; /* Critical: No gap */
  position: relative !important;
  z-index: 1 !important;
  box-shadow: none !important; /* Remove box shadow */
  color: var(--cm-text) !important; /* Use theme text color */
}

body[data-theme="dark"] .cm-extension .tag-strategy-hint-content {
  background-color: var(
    --cm-dropdown-bg
  ) !important; /* Use theme variable for consistency */
  border: none !important; /* No borders */
  border-radius: 0 10px 10px 10px !important; /* Match 10px radius */
  margin-top: 0px !important; /* No gap */
  color: var(--cm-text) !important; /* Use theme text color */
}

@keyframes expandStrategy {
  from {
    opacity: 0;
    max-height: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    max-height: 300px;
    transform: translateY(0);
  }
}

/* Enhanced scrolling for problem sidebar - FIXED */
.cd-sidenav__content {
  /* Core scrolling setup */
  overflow-y: auto !important;
  overflow-x: hidden !important;
  scroll-behavior: smooth !important;
  scrollbar-width: thin !important;

  /* Ensure proper height and padding to prevent content cutoff */
  height: calc(100vh - 90px) !important;
  max-height: calc(100vh - 90px) !important;
  padding-bottom: 5px !important;

  /* Enable smooth scrolling on webkit */
  -webkit-overflow-scrolling: touch !important;
}

/* Fix for strategy expansion - ensure smooth auto-scroll */
.cm-extension .tag-strategy-hint {
  /* Smooth expansion animation */
  animation: expandStrategyContent 0.3s ease-out !important;

  /* Ensure proper spacing and no content blocking */
  margin-top: 0px !important;
  margin-bottom: 16px !important;

  /* Full width within grid */
  grid-column: 1 / -1 !important;
  width: 100% !important;

  /* Ensure visibility */
  position: relative !important;
  z-index: 1 !important;

  /* Smooth scrolling target */
  scroll-margin-top: 20px !important;
}

@keyframes expandStrategyContent {
  from {
    opacity: 0;
    max-height: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    max-height: 300px;
    transform: translateY(0);
  }
}

/* Prevent sidebar from growing beyond viewport */
.cd-sidenav.problem-sidebar-view {
  height: 100vh !important;
  max-height: 100vh !important;
  overflow-x: hidden !important;
  overflow-y: visible !important;
  width: 100% !important;
  max-width: 320px !important;
}

.cm-extension .problem-sidebar-section.tag-strategy-container {
  overflow: visible !important;
  position: relative !important;
  z-index: 10 !important;
  margin-bottom: 4px !important;
}

/* ULTIMATE FIX: Force container height and scrolling - TARGET CORRECT CLASS */
html body .cm-extension .cm-sidenav.problink .cm-sidenav__content,
html body .cm-extension .cd-sidenav.problink .cd-sidenav__content,
html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content,
html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content {
  /* CRITICAL: Force maximum height and scrolling */
  overflow-y: auto !important;
  overflow-x: hidden !important;
  max-height: calc(100vh - 60px) !important;
  height: calc(100vh - 60px) !important;
  scroll-behavior: smooth !important;
  /* Ensure content can't escape container */
  position: relative !important;
  contain: layout !important;
}

/* Override height constraints when strategy map content is expanded */
html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content:has(.expanded),
html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content:has(.expanded),
html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content.strategy-expanded,
html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content.strategy-expanded {
  /* Allow full expansion without scroll bars when strategy content is expanded */
  max-height: none !important;
  height: auto !important;
  overflow-y: visible !important;
  /* Maintain horizontal constraints and remove layout containment */
  overflow-x: hidden !important;
  contain: none !important;
}

/* Ensure expanded strategy container takes full available space */
.tag-strategy-container.expanded {
  max-height: none !important;
  height: auto !important;
  overflow: visible !important;
}

/* Ensure smooth transition when expanding/collapsing */
.tag-strategy-container {
  transition: max-height 0.3s ease-out, height 0.3s ease-out !important;
}

html body .cm-extension .cm-sidenav.problink,
html body .cm-extension .cd-sidenav.problink,
html body .cm-extension .cm-sidenav.problem-sidebar-view,
html body .cm-extension .cd-sidenav.problem-sidebar-view,
html body .problem-sidebar {
  overflow-y: visible !important;
  /* Ensure parent allows child to handle overflow */
  contain: layout !important;
}

/* COPY EXISTING APP SCROLLBAR STYLING FOR PROBLEM SIDEBAR */
html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar,
html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar,
html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar,
html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar {
  width: 8px !important;
}

html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar-track,
html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar-track,
html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar-track,
html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar-track {
  background: var(--cm-bg) !important;
  border-radius: 4px !important;
}

html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar-thumb,
html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar-thumb,
html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar-thumb,
html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar-thumb {
  background: var(--cm-dropdown-bg) !important;
  border-radius: 4px !important;
  transition: background-color 0.3s ease !important;
}

html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar-thumb:hover,
html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar-thumb:hover,
html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar-thumb:hover,
html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar-thumb:hover {
  background: var(--cm-link) !important;
}

/* Dark theme scrollbar for problem sidebar */
body[data-theme="dark"] html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar-track,
body[data-theme="dark"] html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar-track,
body[data-theme="dark"] html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar-track,
body[data-theme="dark"] html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar-track {
  background: #1f2937 !important;
}

body[data-theme="dark"] html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar-thumb,
body[data-theme="dark"] html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar-thumb,
body[data-theme="dark"] html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar-thumb,
body[data-theme="dark"] html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar-thumb {
  background: #374151 !important;
}

body[data-theme="dark"] html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar-thumb:hover,
body[data-theme="dark"] html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar-thumb:hover,
body[data-theme="dark"] html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar-thumb:hover,
body[data-theme="dark"] html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar-thumb:hover {
  background: #4b5563 !important;
}

/* Light theme scrollbar for problem sidebar */
body[data-theme="light"] html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar-track,
body[data-theme="light"] html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar-track,
body[data-theme="light"] html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar-track,
body[data-theme="light"] html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar-track {
  background: #f8fafc !important;
}

body[data-theme="light"] html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar-thumb,
body[data-theme="light"] html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar-thumb,
body[data-theme="light"] html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar-thumb,
body[data-theme="light"] html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar-thumb {
  background: #e2e8f0 !important;
}

body[data-theme="light"] html body .cm-extension .cm-sidenav.problink .cm-sidenav__content::-webkit-scrollbar-thumb:hover,
body[data-theme="light"] html body .cm-extension .cd-sidenav.problink .cd-sidenav__content::-webkit-scrollbar-thumb:hover,
body[data-theme="light"] html body .cm-extension .cm-sidenav.problem-sidebar-view .cm-sidenav__content::-webkit-scrollbar-thumb:hover,
body[data-theme="light"] html body .cm-extension .cd-sidenav.problem-sidebar-view .cd-sidenav__content::-webkit-scrollbar-thumb:hover {
  background: #cbd5e1 !important;
}

/* Strategy expansion animation with seamless tab connection */
.cm-extension .tag-strategy-hint {
  animation: expandStrategy 0.3s ease-out !important;
  margin-top: 0px !important;
  margin-bottom: 12px !important;
  position: relative !important;
  z-index: 1 !important;
  grid-column: 1 / -1 !important;
}

@keyframes expandStrategy {
  from {
    opacity: 0;
    max-height: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    max-height: 200px;
    transform: translateY(0);
  }
}

/* ===== NUCLEAR OVERRIDE: FORCE TAG BUTTON THEME COLORS ===== */
/* Maximum specificity to override any existing rules */
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button,
.cm-extension .tag-strategy-button,
button.tag-strategy-button,
[class*="tag-strategy-button"] {
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  border: none !important;
  border-radius: 16px !important;
}

/* NUCLEAR OVERRIDE: Hover states */
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ),
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ),
.cm-extension
  .tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ),
button.tag-strategy-button:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ),
[class*="tag-strategy-button"]:hover:not(.tag-strategy-button-expanded):not(
    .tag-strategy-no-hover
  ) {
  /* Removed yellow background from this rule too */
  color: var(--cm-text) !important;
}

/* NUCLEAR OVERRIDE: SEAMLESS TAB-TO-CONTENT CONNECTION */
.tag-strategy-hint,
.cm-extension .tag-strategy-hint-content {
  margin-top: 0px !important; /* No gap between tab and content */
  border: none !important; /* Remove all borders */
  box-shadow: none !important; /* Remove shadows */
  background-color: var(--cm-dropdown-bg) !important; /* Theme background */
  color: var(--cm-text) !important; /* Theme text color */
}

/* Ensure strategy content has proper notebook-style connection */
.cm-extension .tag-strategy-hint-content {
  border-radius: 0 10px 10px 10px !important; /* Match 10px radius, round all corners except top-left */
  margin-bottom: 16px !important; /* Space after content but not before */
}

/* ULTRA NUCLEAR: Override ALL possible conflicting rules with maximum specificity */
html body[data-theme="light"] .tag-strategy-hint-content,
html body[data-theme="dark"] .tag-strategy-hint-content,
html body .problem-sidebar .tag-strategy-hint-content,
html body .cm-extension .tag-strategy-hint-content,
html body div.cd-sidenav div.cd-sidenav__content .tag-strategy-hint-content,
body[data-theme="light"] .tag-strategy-hint-content,
body[data-theme="dark"] .cm-extension .tag-strategy-hint-content {
  background-color: var(--cm-dropdown-bg) !important;
  border: none !important;
  border-radius: 0 10px 10px 10px !important; /* Match 10px radius */
  box-shadow: none !important;
  color: var(--cm-text) !important;
  margin-top: 0px !important;
  margin-bottom: 16px !important;
  padding: 12px !important;
}

/* ULTRA NUCLEAR: Tag buttons with absolute maximum specificity */
html
  body[data-theme="light"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button,
html
  body[data-theme="dark"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button[type="button"],
html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button[class*="tag-strategy-button"] {
  padding: 8px 12px !important;
  margin: 4px !important;
  min-height: 36px !important;
  border-radius: 16px !important;
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  border: none !important;

}

/* ULTRA NUCLEAR: Expanded tab state with absolute maximum specificity */
html
  body[data-theme="light"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded,
html
  body[data-theme="dark"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[type="button"],
html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[class*="tag-strategy-button"] {
  border-radius: 10px 10px 0px 0px !important; /* Updated for better connection */
  margin: 0px !important;
  margin-bottom: 0px !important;
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  border: none !important;
  border-bottom: none !important;
  z-index: 2 !important;
}

/* ULTRA NUCLEAR: Remove hover effects on expanded/active tabs - Maximum Specificity */
html
  body[data-theme="light"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded:hover,
html
  body[data-theme="dark"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[type="button"]:hover,
html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded[class*="tag-strategy-button"]:hover,
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button-expanded:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded:hover,
.cm-extension .tag-strategy-button-expanded:hover,
button.tag-strategy-button-expanded:hover,
[class*="tag-strategy-button-expanded"]:hover {
  background-color: var(
    --cm-dropdown-bg
  ) !important; /* Keep same background as non-hover */
  color: var(--cm-text) !important; /* Keep same text color */
  transform: none !important; /* No hover animation */
  box-shadow: none !important; /* No hover shadow */
  margin: 0px !important; /* Keep tight connection */
  margin-bottom: 0px !important;
  border: none !important;
  border-radius: 10px 10px 0px 0px !important; /* Maintain tab shape on hover */
}

/* ULTIMATE NUCLEAR: Override the specific hover rule - NO YELLOW HOVER ON ANY EXPANDED TABS */
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button-expanded:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded:hover,
.cm-extension .tag-strategy-button-expanded:hover,
button.tag-strategy-button-expanded:hover,
[class*="tag-strategy-button-expanded"]:hover,
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button.tag-strategy-button-expanded:hover,
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  .tag-strategy-simple-grid button[aria-expanded="true"]:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  button[aria-expanded="true"]:hover,
.cm-extension .tag-strategy-simple-grid button[aria-expanded="true"]:hover,
.tag-strategy-simple-grid button[aria-expanded="true"]:hover,
[class*="tag-strategy-button"][aria-expanded="true"]:hover {
  background-color: var(
    --cm-dropdown-bg
  ) !important; /* NO highlight color change */
  color: var(--cm-text) !important; /* Keep same text color */
  border-radius: 10px 10px 0px 0px !important; /* Maintain tab shape */
  transform: none !important; /* No hover effects */
  box-shadow: none !important; /* No hover shadow */
}

/* MEGA NUCLEAR: Target expanded tabs by class AND aria-expanded attribute */
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button-expanded,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button-expanded,
.cm-extension .tag-strategy-button-expanded,
button.tag-strategy-button-expanded,
[class*="tag-strategy-button-expanded"],
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  .tag-strategy-simple-grid button[aria-expanded="true"],
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  button[aria-expanded="true"],
.cm-extension .tag-strategy-simple-grid button[aria-expanded="true"],
.tag-strategy-simple-grid button[aria-expanded="true"],
[class*="tag-strategy-button"][aria-expanded="true"] {
  border-radius: 10px 10px 0px 0px !important; /* Tab shape when expanded */
  margin: 0px !important; /* No margins for seamless connection */
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  border: none !important;
  z-index: 2 !important;
}

/* ULTIMATE NUCLEAR: Override the exact hover rule that's causing yellow with maximum specificity */
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button.tag-strategy-button-expanded:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button.tag-strategy-button-expanded:hover,
.cm-extension .tag-strategy-button.tag-strategy-button-expanded:hover,
button.tag-strategy-button.tag-strategy-button-expanded:hover,
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button[aria-expanded="true"]:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button[aria-expanded="true"]:hover,
.cm-extension .tag-strategy-button[aria-expanded="true"]:hover,
button.tag-strategy-button[aria-expanded="true"]:hover,
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button[class*="tag-strategy-button-expanded"]:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-button[class*="tag-strategy-button-expanded"]:hover {
  background-color: var(
    --cm-dropdown-bg
  ) !important; /* Override the yellow hover */
  color: var(--cm-text) !important;
  border-radius: 10px 10px 0px 0px !important;
  transform: none !important;
  box-shadow: none !important;
}

/* ABSOLUTE NUCLEAR: Direct override with maximum possible specificity */
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button:hover.tag-strategy-button-expanded,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  button.tag-strategy-button:hover.tag-strategy-button-expanded,
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-button[aria-expanded="true"]:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  button.tag-strategy-button[aria-expanded="true"]:hover,
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button[class*="tag-strategy-button"]:hover.tag-strategy-button-expanded,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  button[class*="tag-strategy-button"]:hover.tag-strategy-button-expanded,
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button[class*="tag-strategy-button"][aria-expanded="true"]:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  button[class*="tag-strategy-button"][aria-expanded="true"]:hover {
  background-color: var(
    --cm-dropdown-bg
  ) !important; /* Absolute override - NO YELLOW */
  color: var(--cm-text) !important;
}

/* JAVASCRIPT + CSS NUCLEAR APPROACH: Disable hover with new class */
.tag-strategy-no-hover:hover,
.tag-strategy-no-hover:hover,
button.tag-strategy-no-hover:hover,
[class*="tag-strategy-no-hover"]:hover,
html body .tag-strategy-no-hover:hover,
html body button.tag-strategy-no-hover:hover,
html body [class*="tag-strategy-no-hover"]:hover,
html body div.cm-sidenav .tag-strategy-no-hover:hover,
html body .cm-extension .tag-strategy-no-hover:hover,
html body div.cm-sidenav div.cm-sidenav__content .tag-strategy-no-hover:hover,
html body .cm-extension .problem-sidebar .tag-strategy-no-hover:hover,
html
  body
  div.cm-sidenav
  div.cm-sidenav__content
  div.problem-sidebar-section.tag-strategy-container
  div.tag-strategy-simple-grid
  button.tag-strategy-no-hover:hover,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid
  .tag-strategy-no-hover:hover {
  background-color: var(
    --cm-dropdown-bg
  ) !important; /* Force theme background */
  color: var(--cm-text) !important; /* Force theme text */
  transform: none !important; /* No transforms */
  box-shadow: none !important; /* No shadows */
  border: none !important; /* No borders */
  border-radius: 10px 10px 0px 0px !important; /* Keep tab shape */
  margin: 0px !important; /* No margins */
}

/* ULTRA NUCLEAR: Force zero grid gap with maximum specificity */
html
  body[data-theme="light"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid,
html
  body[data-theme="dark"]
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid,
html
  body
  .cm-extension
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .tag-strategy-simple-grid,
html
  body
  div.cd-sidenav
  div.cd-sidenav__content
  .problem-sidebar
  .problem-sidebar-section.tag-strategy-container
  .cm-extension .tag-strategy-simple-grid {
  gap: 0px !important;
  grid-gap: 0px !important;
  column-gap: 0px !important;
  row-gap: 0px !important;
  grid-column-gap: 0px !important;
  grid-row-gap: 0px !important;
}

/* MEGA NUCLEAR: Force zero gap on ALL grid rules with maximum specificity */
.tag-strategy-simple-grid,
div.tag-strategy-simple-grid,
.cm-extension .tag-strategy-simple-grid,
body .tag-strategy-simple-grid,
html body .tag-strategy-simple-grid,
html body div .tag-strategy-simple-grid,
html body div.cd-sidenav .tag-strategy-simple-grid,
html body div.cd-sidenav div.cd-sidenav__content .tag-strategy-simple-grid,
[class*="tag-strategy-simple-grid"] {
  gap: 0px !important;
  grid-gap: 0px !important;
  column-gap: 0px !important;
  row-gap: 0px !important;
  grid-column-gap: 0px !important;
  grid-row-gap: 0px !important;
  margin-bottom: 12px !important;
  padding: 0px !important;
}

/* ULTIMATE NUCLEAR: Override the specific .cm-extension rule that's causing the gap */
html body .cm-extension .tag-strategy-simple-grid,
body .cm-extension .tag-strategy-simple-grid,
.cm-extension .tag-strategy-simple-grid {
  display: grid !important;
  grid-template-columns: 1fr 1fr !important;
  gap: 0px !important; /* Override the 6px gap */
  grid-gap: 0px !important;
  column-gap: 0px !important;
  row-gap: 0px !important;
  margin-bottom: 12px !important;
  padding: 0px !important; /* Override the 4px padding */
  width: 100% !important;
  max-width: 100% !important;
  box-sizing: border-box !important;
}

/* MEGA NUCLEAR: Force zero margin on expanded tabs to eliminate any space + pill-to-tab transition */
.tag-strategy-button-expanded,
button.tag-strategy-button-expanded,
[class*="tag-strategy-button-expanded"] {
  margin: 0px !important;
  margin-top: 0px !important;
  margin-bottom: 0px !important;
  margin-left: 0px !important;
  margin-right: 0px !important;
  padding-bottom: 0px !important;
  border-bottom: none !important;
  position: relative !important;
  z-index: 10 !important;

  /* CRITICAL: Pill-to-tab transition - rounded top, square bottom */
  border-radius: 10px 10px 0px 0px !important; /* Better connection with 10px radius */
  background-color: var(--cm-dropdown-bg) !important;
  color: var(--cm-text) !important;
  border: none !important;
}

/* MEGA NUCLEAR: Force zero margin and gap on strategy hint */
.cm-extension .tag-strategy-hint {
  margin: 0px !important;
  margin-top: 0px !important;
  margin-bottom: 16px !important;
  padding: 0px !important;
  padding-top: 0px !important;
  grid-column: 1 / -1 !important;
  position: relative !important;
  z-index: 5 !important;
}

/* Fix excessive empty space at bottom of sidebar */
.cm-extension .cm-sidenav__content {
  display: flex !important;
  flex-direction: column !important;
  justify-content: flex-start !important;
  height: calc(100vh - 90px) !important; /* Account for margin-top: 10px */
  max-height: calc(100vh - 90px) !important;
  padding-bottom: 5px !important; /* Minimal padding */
  box-sizing: border-box !important;
}


